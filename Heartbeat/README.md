# Heartbeat 프로젝트

생체 오디오(심장음)에서 유용한 특징을 추출하고 전통적 ML과 딥러닝(CNN/1D-CNN)으로 이상 탐지를 학습·평가하는 프로젝트입니다.

1. 웨이블릿 기반 특징 추출 (wavelet.py)
-1차원 신호를 일정 길이(segment_length=512)로 분할
-각 세그먼트에 대해 5단계 db4 웨이블릿 변환 수행
-계수별 통계적 특징 추출: 평균(mean), 표준편차(std), 최댓값(max), 최솟값(min), 중앙값(median), 에너지(energy)

2. MFCC + Mel-Spectrogram 기반 특징 추출 (mfs.py)
-MFCC(13차원) 및 Mel-Spectrogram(40차원) 추출
-두 특징을 결합하여 2차원 배열(53 × T) 생성 (T: 시간 프레임 개수)

3. 1차원 데이터 학습
-1개의 데이터를 전체를 nn.Conv1d를 이용해 학습
-1개의 데이터를 1초 단위로 잘라서 학습

4. 데이터 시각화
- 음성 데이터의 y축 값 (진폭)을 이용해 1차원 벡터를 (y1y2y3y4y5y...)을 (x1y1x2y2..)변환을 통해 시각화

5. 데이터 불균형 해소
- 비교적 적은 비정상 데이터를 물리적 복사를 통해 데이터 셋의 균형을 맞춘 후 웨이블릿 변환 후 학습
- GAN을 이용해 비교적 적은 데이터를 이용해 가짜 데이터를 생성 후 데이터 셋의 균형을 맞춘 후 웨이블릿 변환 후 학습

## 1. 프로젝트 개요
- 입력: WAV 형식의 심장음

- 목표: 
  - 특징 추출(웨이블릿, MFCC+Mel-Spectrogram)
  - 1D/2D CNN 등 모델 학습
  - 데이터 불균형 처리 및 시각화

- 출력: 
  - 전처리된 특징(CSV, NPY)
  - 학습된 모델과 실험 로그

## 2. 기능 요약
- 웨이블릿(db4, 5단) 기반 특징: 각 세그먼트 통계(평균/표준편차/최대/최소/중앙값/에너지)
- MFCC(13) + Mel-Spectrogram(40): 2D 특성 맵(총 53채널)

- 1D-CNN 학습
  - 전체 시퀀스 학습
  - 슬라이딩 윈도우 학습(window_size/stride)

- 데이터 불균형 처리
  - 물리적 복제(oversampling)
  - GAN 기반 synthetic data (실험 옵션)

- 시각화: 파형, 스펙트로그램 등

## 3. 데이터 형식
- 오디오: WAV
- 라벨 CSV 예시(파일명 기준):
  - columns: filename, label
  - filename: 확장자 없는 파일명(예: a0001)
  - label: 정수 클래스(예: 0=정상, 1=비정상)
- 참고: change_csv/change.py로 -1 라벨을 0으로 치환 가능

## 4. 슬라이딩 윈도우 설정
- window_size: 샘플 개수
- stride: 윈도우 간 이동 샘플 수
- 초 단위 변환: seconds = window_size / sample_rate
  - 예: sample_rate=16000일 때 window_size=16000 → 1.0초, stride=8000 → 0.5초(50% 겹침)
- 권장: 모든 파일을 동일 sample_rate(TARGET_SR=16000 등)로 리샘플링해 일관성 유지

## 5. 데이터 불균형 처리
- 단순 Oversampling: 소수 클래스 파일 복제/가중치 부여
- GAN 기반 합성: 소수 클래스 데이터로 synthetic sample 생성 후 합치기
- 주의: 과적합 방지(검증셋은 원본 분포 유지)

## 6. 시각화
- 파형/스펙트로그램 플롯
- 1D 벡터 시각화: (y1,y2,...) → (x1,y1,x2,y2,...) 변환 그래프
- 모델 학습 곡선(Train/Val Loss, Acc) 저장